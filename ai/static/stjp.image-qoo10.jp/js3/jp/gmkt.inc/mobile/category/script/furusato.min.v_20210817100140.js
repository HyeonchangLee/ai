// (c)2021 eBay Japan

var ranking_swiper=null;$(document).ready(function(){$('input').not("#input_keyword").keydown(function(){if(event.keyCode===13){event.preventDefault();}});$("#btn_limit_edit").bind("click",function(){var cookie_donation_limit=Util.getCookie("furusato_simulation_amt");if(cookie_donation_limit!=""){cookie_donation_limit=cookie_donation_limit.replace(v_unit,"").replace(/,/g,"");}
var limitAmt=window.prompt(MultiLang.findResource("12文字以下の数字で入力してください。"),cookie_donation_limit);var intAmt=0;if(limitAmt!=null&&Util.isNumber(limitAmt)&&limitAmt.length<13){intAmt=parseInt(limitAmt);var value=PriceUtil.FormatCurrency(intAmt)+v_unit;Util.setCookie("furusato_simulation_amt",intAmt,undefined,365*3);$("#u_limit_amt").html(value);}
else if(limitAmt!=null&&(!Util.isNumber(limitAmt)||limitAmt.length>12)){alert(MultiLang.findResource("12文字以下の数字で入力してください。"));}});$(document).on("click","button[name=btn_wish]",function(e){WishItems.proSetWishList=true;WishItems.isShowToast=false;WishItems.setWishList(this,"selected");if(e){e.preventDefault();e.stopPropagation();}});initializeElementSetting();});var isSearchResponse=false;var MobileSearchItemList={total_page_no:v_total_page_no,total_item_count:v_total_size,selected_brand_no:"0",selected_ship_from_nation_cd:"",search_in_result_keywords:[],is_ajax_processing:false,change_sort_type:false,param_research_yn:"N",param_display_type:v_dispType,param_keyword:"",param_additional_keyword:"",param_search_option:"",param_gdlc_cd:v_gdlc_cd,param_gdmc_cd:"",param_gdsc_cd:"",param_sort_type:"",param_page_no:v_page_no,param_page_size:v_page_size,param_brand_no:"0",param_ship_from_nation_cd:"",param_ship_to_nation_cd:v_ship_to_nation_code,param_min_price:"",param_max_price:"",param_coupon_filter_no:"0",param_partial_match_option:"off",param_affiliate_group:"0",param_qx_delivery_search_yn:"N",param_quality_shipping_search_yn:"N",param_eticket_search_yn:"N",param_free_shipping_search_yn:"N",param_select_facet_type:"",param_header_search_keyword:"",param_is_initialize:"",initParameterValue:function(init_type){if(init_type=="parameter"){MobileSearchItemList.param_page_no=1;MobileSearchItemList.total_page_no=0;}},getSearchParameter:function(search_type){if(Number(MobileSearchItemList.param_min_price)>0&&Number(MobileSearchItemList.param_max_price)>0&&(Number(MobileSearchItemList.param_min_price)>Number(MobileSearchItemList.param_max_price))){var min_price_value=MobileSearchItemList.param_min_price;var max_price_value=MobileSearchItemList.param_max_price;MobileSearchItemList.param_min_price=max_price_value;MobileSearchItemList.param_max_price=min_price_value;}
if(MobileSearchItemList.param_coupon_filter_no==undefined){MobileSearchItemList.param_coupon_filter_no="0";}
var parameter="?search_type="+search_type;parameter+="&page_no="+MobileSearchItemList.param_page_no;parameter+="&page_size="+MobileSearchItemList.param_page_size;parameter+="&sort_type="+MobileSearchItemList.param_sort_type;parameter+="&partial="+MobileSearchItemList.param_partial_match_option;parameter+="&disp_type="+MobileSearchItemList.param_display_type;parameter+="&qx_delivery_search_yn="+MobileSearchItemList.param_qx_delivery_search_yn;parameter+="&eticket_search_yn="+MobileSearchItemList.param_eticket_search_yn;parameter+="&ship_to_nation_cd="+MobileSearchItemList.param_ship_to_nation_cd;parameter+="&research_yn="+MobileSearchItemList.param_research_yn;parameter+="&furusato_badge_yn=n";parameter+="&"+mobileFilterUI.getFilterParameter(search_type);return parameter;},executeItemQuery:function(is_initialize){if(is_initialize){mobileFilterUI.ShowFilterLoading();MobileSearchItemList.initParameterValue("parameter");MobileSearchItemList.param_is_initialize="Y";if(mobileFilterUI.selectFilterValue.param_gdmc_cd==""&&mobileFilterUI.selectFilterValue.param_gdmc_cd==""){if($("#ul_category_list").find("li.on").length>0){var selected_gdmc_cds=$("#ul_category_list").find("li.on").eq(0).attr("data-category-cd");new qoo10_func.furusatoCtgSubCheck();if(selected_gdmc_cds==v_furusato_gdlc_cd){selected_gdmc_cds="";}
var selected_gdsc_cds="";if($("#furusato_ctg_sub").find("button[name=btn_medium].selected").length>0){selected_gdmc_cds=$("#furusato_ctg_sub").find("button[name=btn_medium].selected").eq(0).attr("data-category-cd");if($("#furusato_ctg_sub").find("button[name=btn_small].selected").length>0){selected_gdsc_cds=$("#furusato_ctg_sub").find("button[name=btn_small].selected").eq(0).attr("data-category-cd");if(selected_gdsc_cds!=null&&selected_gdsc_cds!=undefined){if(selected_gdsc_cds.indexOf("2")==0){selected_gdmc_cds=selected_gdsc_cds;selected_gdsc_cds="";}}else{selected_gdsc_cds="";}}}
mobileFilterUI.selectFilterValue.param_gdmc_cd=selected_gdmc_cds.replace(/_/g,",");mobileFilterUI.selectFilterValue.param_gdsc_cd=selected_gdsc_cds.replace(/_/g,",");}}}else{MobileSearchItemList.param_is_initialize="";}
MobileSearchItemList.param_display_type=gdListGrid.listType;MobileSearchItemList.disp_type=gdListGrid.listType;$("#div_lst_more").show();MobileSearchItemList.plus_item_fill="";var search_item_url=Public.getCurrentHostUrl()+"/gmkt.inc/Mobile/Search/MobileSearchAjaxAppend.aspx"+MobileSearchItemList.getSearchParameter("category_item");RMSHelper.asyncCallWebObject(search_item_url,"post",null,MobileSearchItemList.executeItemQueryResult);},executeItemQueryResult:function(result,svc,xml_http){$("#div_lst_more").hide();MobileSearchItemList.is_ajax_processing=false;var total_item_count=0;if(result!=null&&result!=undefined){MobileSearchItemList.total_page_no=Number(xml_http.getResponseHeader("total_page_no"));MobileSearchItemList.total_item_count=Number(xml_http.getResponseHeader("total_item_count"));total_item_count=MobileSearchItemList.total_item_count;if(MobileSearchItemList.param_is_initialize!=""){mobileFilterUI.ToastResultMsg(total_item_count);var selected_class=gdListGrid.listType;if(total_item_count>0)
$("#div_item_list").html(result);else
$("#div_item_list").html("");$("#div_control_item_list").removeClass().addClass('list2021 '+selected_class);}else{$("#div_control_item_list").append($(result).find("li").parent().html());}
getWishGDNoListMarking({targets:[{gd_attrname:"data_gd_no",selected_classname:"selected"}]});if(MobileSearchUtil&&MobileSearchUtil.processSearchResult)
MobileSearchUtil.processSearchResult();}else
MobileSearchItemList.total_item_count=0;isSearchResponse=true;mobileFilterUI.setTotalCount(MobileSearchItemList.total_item_count);MobileSearchItemList.change_sort_type=false;mobileFilterUI.setFilterClearSection();if(has_header){if(MobileSearchItemList.total_item_count==0)
$("#div_main_filter_search_no_data").show();else
$("#div_main_filter_search_no_data").hide();}
mobileFilterUI.HideFilterLoading();},executeSummaryInfo:function(is_initialize){var search_item_url=Public.getCurrentHostUrl()+"/gmkt.inc/Mobile/Search/MobileSearchAjaxAppend.aspx"+MobileSearchItemList.getSearchParameter("category_item");RMSHelper.asyncCallWebObject(search_item_url,"post",null,MobileSearchItemList.executeSummaryInfoResult);},executeSummaryInfoResult:function(result,svc,xml_http){total_item_count=Number(xml_http.getResponseHeader("total_item_count"));if(mobileFilterUI){mobileFilterUI.setPreviewSearchResult(total_item_count);}}}
var mobileFilterUI=new MobileFilterUI({search_keyword:MobileSearchItemList.param_keyword,total_item_count:v_total_size,category:{gdlc_cd:MobileSearchItemList.param_gdlc_cd,gdmc_cd:MobileSearchItemList.param_gdmc_cd,gdsc_cd:MobileSearchItemList.param_gdsc_cd},visible:{coupon:false},brand_no:MobileSearchItemList.param_brand_no,price_range:{min:v_search_goods_min_price,max:v_search_goods_max_price},callback:{reset:function(){mobileFilterUI.SetToastResultMsgEnable(false);MobileSearchItemList.executeItemQuery(true);},clear:function(default_settings,selectFilterValue){mobileFilterUI.SetToastResultMsgEnable(false);MobileSearchItemList.executeItemQuery(true);},apply:function(parameters,selectFilterValue){MobileSearchItemList.executeItemQuery(true);},previewResult:function(parameters,selectFilterValue){MobileSearchItemList.executeSummaryInfo(true);},sortClick:function(sort_type){mobileFilterUI.SetToastResultMsgEnable(false);MobileSearchItemList.param_sort_type=sort_type;MobileSearchItemList.change_sort_type=true;MobileSearchItemList.disp_type=gdListGrid.listType;MobileSearchItemList.executeItemQuery(true);},goodsviewtypeClick:function(goodsviewtype){gdListGrid.listType=goodsviewtype;}}});function getCategoryCdInfo(){var gdmc_cds="",gdmc_cd="",gdsc_cd="";gdmc_cds=$("#ul_category_list > li.on").attr("data-category-cd");if(gdmc_cds==null||gdmc_cds==="undefined"||gdmc_cds==v_furusato_gdlc_cd)
gdmc_cds="";gdmc_cd=$("#furusato_ctg_sub > li > button.selected").attr("data-category-cd");if(gdmc_cd==null||gdmc_cd==="undefined"||gdmc_cd==v_furusato_gdlc_cd)
gdmc_cd="";gdsc_cd=$("#furusato_ctg_sub > li > ul.sub_depth3 button.selected").attr("data-category-cd");if(gdsc_cd==null||gdsc_cd==="undefined")
gdsc_cd="";gdmc_cds=gdmc_cds.replace(/_/g,",");return{gdlc_cd:v_furusato_gdlc_cd,gdmc_cd:gdmc_cd!=""?gdmc_cd:gdmc_cds,gdsc_cd:gdsc_cd};}
function initCategoryRegion(){var obj=$("#ul_category_list a.ctg_"+v_furusato_gdlc_cd)[0];groupBtnClick(obj,v_furusato_gdlc_cd,false);var swiper=document.querySelector("#div_cate_list_img").swiper;if(typeof swiper!=="undefined"){swiper.update();swiper.slideTo(0);}}
function initializeElementSetting(){if(MobileSearchUtil&&MobileSearchUtil.processSearchResult)
MobileSearchUtil.processSearchResult();gdListGrid.listType="";if(Number(MobileSearchItemList.total_item_count)>0){MobileSearchItemList.param_research_yn="Y";}
ranking_swiper=new Swiper("#div_ranking_body",{slidesPerView:"auto",spaceBetween:0});$(window).on("scroll",function(){if(MobileSearchItemList.total_page_no<1){$("#div_lst_more").hide();}else if(MobileSearchItemList.total_page_no>=1){if(MobileSearchItemList.param_page_no==1){if(MobileSearchItemList.total_page_no==1){$("#div_lst_more").hide();}else{$("#div_lst_more").show();}}
searchItemMoreBtn();}});}
function getRankingData(){var url=Public.getCurrentHostUrl()+"/gmkt.inc/Mobile/Category/FurusatoRankingAjaxAppend.aspx?gdmc_cd="+mobileFilterUI.selectFilterValue.param_gdmc_cd;RMSHelper.asyncCallWebObject(url,"post",null,getRankingDataResult);}
function getRankingDataResult(result,svc,methodName){if(result!=null&&$.trim(result)!=""){$("#div_ranking_body").show();$("#ul_ranking_content").html(result);if(typeof ranking_swiper!=="undefined"&&ranking_swiper!=null){ranking_swiper.update();ranking_swiper.slideTo(0);}}
else
$("#div_ranking_body").hide();}
function groupImgSwitch(imgObj){var parentLi=imgObj.parent().parent();var src="";imgObj.hide();if(parentLi.hasClass("on")){$(imgObj[1]).show();}
else{$(imgObj[0]).show();}}
function groupBtnClick(obj,gdmc_cds,isReset){var sectionGroup=$("#ul_category_list li[data-category-cd="+gdmc_cds+"]");var sectionImgObj=$(obj).find("img");var currentOnImgObj=$("#ul_category_list li.on img");$("#furusato_ctg_sub > li > button.selected").removeClass("selected");groupImgSwitch(currentOnImgObj);$("#ul_category_list li").removeClass("on");groupImgSwitch(sectionImgObj);sectionGroup.addClass("on");if(gdmc_cds==v_furusato_gdlc_cd)
$("#furusato_ctg_sub").hide();else
$("#furusato_ctg_sub").show();var tmpArray=gdmc_cds.split("_");$("#furusato_ctg_sub > li.ctg_sub_li").hide();for(var i=0;i<tmpArray.length;i++){$("#furusato_ctg_sub > #medium_"+tmpArray[i]).show();}
new qoo10_func.furusatoCtgSubCheck();if(gdmc_cds==v_furusato_gdlc_cd){gdmc_cds="";$("#a_ranking_more").show();}
else
$("#a_ranking_more").hide();if(isReset){$('#btn_filter_refresh').trigger('click',false);}
mobileFilterUI.selectFilterValue.param_gdmc_cd=gdmc_cds.replace(/_/g,",");mobileFilterUI.selectFilterValue.param_gdsc_cd="";getRankingData();MobileSearchItemList.executeItemQuery(true);}
function mediumBtnClick(obj,gdmc_cd,isReset){var currentMediumID=$("#furusato_ctg_sub li button[name=btn_medium].selected").attr("id");var selectedMediumID=obj!=null?$(obj).attr("id"):"";$("#furusato_ctg_sub ul.sub_depth3 button").removeClass("selected");$("#btn_small_all_"+gdmc_cd).addClass("selected");if(isReset){$('#btn_filter_refresh').trigger('click',false);}
mobileFilterUI.selectFilterValue.param_gdmc_cd=gdmc_cd;mobileFilterUI.selectFilterValue.param_gdsc_cd="";getRankingData();MobileSearchItemList.executeItemQuery(true);}
function smallBtnclick(obj,gdsc_cd){$("#div_ranking_body").hide();$("#furusato_ctg_sub ul.sub_depth3 button").removeClass("selected");$(obj).addClass("selected");mobileFilterUI.reset();if(gdsc_cd.indexOf("2")==0){mobileFilterUI.selectFilterValue.param_gdmc_cd=gdsc_cd;mobileFilterUI.selectFilterValue.param_gdsc_cd="";getRankingData();}
else
mobileFilterUI.selectFilterValue.param_gdsc_cd=gdsc_cd;MobileSearchItemList.executeItemQuery(true);}
function searchItemMoreBtn(){if(MobileSearchItemList.total_page_no>1){var base_obj=$("#div_control_item_list").find("li:eq("+parseInt(MobileSearchItemList.param_page_size*(MobileSearchItemList.param_page_no-1)+MobileSearchItemList.param_page_size/2)+")");var base_height=$(base_obj).length>0?$(base_obj).offset().top:$(window).scrollTop()+$(window).height();if($(window).scrollTop()+$(window).height()>base_height&&!MobileSearchItemList.is_ajax_processing){MobileSearchItemList.is_ajax_processing=true;if(MobileSearchItemList.param_page_no<MobileSearchItemList.total_page_no){MobileSearchItemList.param_page_no++;MobileSearchItemList.executeItemQuery(false);}}}}